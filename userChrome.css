@media (prefers-color-scheme: dark) {
  :root {
      --bg: #1a1b26;

      --urlbar-bg: #0d0d15;
      --urlbar-border-top: #000;
      --urldrop-bg: #0d0d15;
      --urlbar-border-bottom: #404040;
      --urlbar-height: 30px;
      --urlbar-outline: #414868;

      --fullscreen-warn: rgb(25, 25, 25);

      --arrowpanel-background: var(--urlbar-bg) !important;
      --button-hover-bgcolor: rgba(159, 159, 159, 0.35) !important;
      --button-active-bgcolor: rgba(255, 255, 255, 0.2) !important;
      --button-bgcolor: rgba(117, 117, 117, 0.9) !important;
      --toolbarbutton-icon-fill-opacity: 0.8 !important;
      --arrowpanel-border-color: rgb(55, 55, 55) !important;
      --identity-btn-hover-color: rgba(117, 117, 117) !important;

      --dark-menu-background-color: rgba(34, 34, 36, 0.5) !important;
      --dark-menu-border-color: rgb(55, 55, 55) !important;
      --dark-menuitem-hover-background-color: rgba(
          159,
          159,
          159,
          0.35
      ) !important;
  }
}

@media (prefers-color-scheme: light) {
  :root {
      --bg: #f1f5f9;

      --urlbar-bg: #cbd5e1;
      --urlbar-border-top: #9ca3af;
      --urlbar-border-bottom: #fff;
      --urldrop-bg: #cbd5e1;
      --urlbar-outline: #94a3b8;

      --fullscreen-warn: rgb(25, 25, 25);

      --arrowpanel-background: #e2e8f0 !important;
      --button-hover-bgcolor: #9699a3 !important;
      --button-hover-bgcolor: #cbd5e1 !important;
      --button-active-bgcolor: #cbd5e1 !important;
      --identity-btn-hover-color: white !important;
  }
}

/* Suppress Connecting/Waiting/Reading/Transerring */
/* #statuspanel[type="status"] {
 display: none !important;
} */
/* Suppress Link Destination Overlay */
/* #statuspanel[type="overLink"] {
 display: none !important;
} */


/* Idendity icon button */
#identity-icon-box.identity-box-button {
  margin: 3px 0 3px 3px;
  border-radius: 14px !important;
  background-color: var(--bg) !important;
  opacity: 0.8;
}

#identity-icon-box.identity-box-button:hover {
  cursor: pointer;
  background-color: var(--identity-btn-hover-color) !important;
}

/* Track protection icon */
#tracking-protection-icon-container {
  border-radius: 16px !important;
}

#tracking-protection-icon-container:hover {
  cursor: pointer !important;
}

/* Star button */
#star-button-box {
  border-radius: 16px !important;
}

#star-button-box {
  cursor: pointer !important;
}

/* | Borders | */

.tabbrowser-tab::after {
  border: 0 !important;
}
.titlebar-spacer[type="pre-tabs"] {
  border: 0 !important;
}
#navigator-toolbox {
  border: 1 !important;
}

.titlebar-spacer[type="pre-tabs"] {
  border: 0 !important;
}

.tabbrowser-tab::after {
  border: 0 !important;
}

#urlbar-background {
  border: 0 !important;
}

#urlbar[open] > .urlbarView > .urlbarView-body-outer > .urlbarView-body-inner {
  border-top: 0 !important;
}

/* Active Tab */
:root:not([lwt-default-theme-in-dark-mode]) .tab-background[selected],
.tab-background[multiselected="true"] {
  background: rgba(0, 0, 0, 0.05) !important;
}

:root[lwt-default-theme-in-dark-mode] .tab-background[selected],
.tab-background[multiselected="true"] {
  background: rgba(0, 0, 0, 0.2) !important;
}

/* Navigation Bar */
#nav-bar {
  background-color: var(--bg) !important;
  padding-right: 0 !important;
}

/* Bookmarks Bar */
#PersonalToolbar {
  background-color: var(--bg) !important;
}

/* Navigation Bar Separator */
#navigator-toolbox {
  border-color: var(--bg) !important;
}

/* Navigation bar Buttons */
toolbarbutton:hover {
  cursor: pointer;
}

/* Show Tab close button on hover */
.tabbrowser-tab:not([pinned]) .tab-close-button {
  display: -moz-box !important;
  opacity: 0;
  visibility: collapse !important;
  transition:
      opacity 0.25s,
      visibility 0.25s ease-in !important;
}
.tabbrowser-tab:not([pinned]):hover .tab-close-button {
  opacity: 1;
  visibility: visible !important;
  border-radius: 3px 3px 3px 3px !important;
}

/* Show URL buttons on Hover */
#nav-bar:not([customizing="true"])
  > #nav-bar-customization-target
  > #urlbar-container:not(:hover)
  > #urlbar:not([focused])
  > #urlbar-input-container
  > #page-action-buttons {
  opacity: 0;
}
#page-action-buttons {
  transition: opacity 0.15s ease;
}
#nav-bar:not([customizing="true"])
  > #nav-bar-customization-target
  > #urlbar-container:not(:hover)
  > #urlbar:not([focused])
  > #urlbar-input-container
  > #tracking-protection-icon-container {
  opacity: 0;
}
#tracking-protection-icon-container {
  transition: opacity 0.15s ease;
}

/*Full Screen Warning*/

#fullscreen-warning {
  background-color: var(--fullscreen-warn) !important;
  border-color: var(--fullscreen-warn) !important;
  max-width: 500px !important;
  max-height: 50px !important;
  border-radius: 50px !important;
  font-size: 12px !important;
  opacity: 0.8 !important;
}

.pointerlockfswarning-generic-text,
.pointerlockfswarning-domain-text {
  font-size: 15px !important;
  color: rgb(255, 255, 255) !important;
  text-shadow: none !important;
}

/* Hide tabs bar and title bar completely for tiling WM */
toolbar#TabsToolbar {
  display: none !important;
  visibility: collapse !important;
  height: 0px;
  min-height: 0 !important;
}
.toolbar-items {
  visibility: collapse;
}

/* Ensure window controls are hidden */
.titlebar-buttonbox-container,
.titlebar-buttonbox {
  display: none !important;
}

/* ----- Move menu buttons ----- */
/* :root {
 --toolbar-start-end-padding: 2px !important;
} */

#nav-bar #PanelUI-button {
  -moz-box-ordinal-group: 0 !important;
  margin-right: 0 !important;
}

#nav-bar #PanelUI-button #PanelUI-menu-button {
  margin-right: 2px !important;
  margin-left: 2px !important;
}

/* toolbar:not([customizing]) > #nav-bar-overflow-button {
 -moz-box-ordinal-group: 1 !important;
}

toolbar:not([customizing]) > #nav-bar-customization-target {
 -moz-box-ordinal-group: 2 !important;
} */

/* ----- Close/min/max fix ----- */
/* Fix popup position */
#appMenu-popup {
  margin-inline: -244px !important;
}

#nav-bar {
  padding-left: 0px !important;
  padding-right: 0px !important;
  position: static !important;
}

/* Window controls hidden for tiling WM - removed visibility rules */

/* Button ordering rules removed - buttons are hidden */

/* Mobile responsive rules removed - window controls hidden */

#toolbar-menubar {
  /* menubar bg color */
  background-color: var(--bg) !important;
}

/* Titlebar button styling removed - buttons are hidden */

/* ========== SIDEBERY + FIREFOX 140 SIDEBAR FIX - RESTORE WORKING HOVER ========== */

/* Hide sidebar header */
#sidebar-header {
  display: none !important;
}

/* Hide all tab elements since using Sidebery */
.tab[selected="true"] {
  visibility: collapse;
  height: 0px;
}

.tabbrowser-tab {
  visibility: collapse;
  height: 0px;
}

.tabbrowser-tab[visuallyselected="true"] {
  visibility: collapse;
  height: 0px;
}

/* ========== FIREFOX 140 AUTO HIDE SIDEBAR - RESTORE WORKING VERSION ========== */

/* Disable new sidebar system that conflicts */
#sidebar-main {
  display: none !important;
}

/* Hide new sidebar launcher button */
#sidebar-button2 {
  display: none !important;
}

/* Core sidebar configuration - WORKING VERSION RESTORED */
#sidebar-box {
  --uc-sidebar-width: 44px;
  --uc-sidebar-hover-width: 260px;
  --uc-autohide-sidebar-delay: 1ms;
  position: relative !important;
  min-width: var(--uc-sidebar-width) !important;
  width: var(--uc-sidebar-width) !important;
  max-width: var(--uc-sidebar-width) !important;
  z-index: 1000 !important;
  overflow: visible !important;
  transition: width 0.15s ease var(--uc-autohide-sidebar-delay) !important;
}

/* Remove absolute positioning approach */

/* Critical: Sidebar expansion on hover - WORKING VERSION RESTORED */
#sidebar-box:hover,
#sidebar-box:focus-within {
  width: var(--uc-sidebar-hover-width) !important;
  min-width: var(--uc-sidebar-hover-width) !important;
  max-width: var(--uc-sidebar-hover-width) !important;
  transition-delay: 0ms !important;
}

/* Hide problematic sidebar splitter */
#sidebar-splitter {
  display: none !important;
}

/* Sidebar content - WORKING VERSION RESTORED */
#sidebar {
  width: 100% !important;
  height: 100% !important;
  min-width: var(--uc-sidebar-width) !important;
  overflow: hidden !important;
  background-color: var(--bg) !important;
}

/* Content area - STABLE SPACING */
#appcontent {
  margin-left: var(--uc-sidebar-width) !important;
  transition: none !important;
}

/* Sidebar expansion overlay using negative margin */
#sidebar-box:hover {
  margin-right: calc(-1 * (var(--uc-sidebar-hover-width) - var(--uc-sidebar-width))) !important;
  z-index: 1001 !important;
}

/* Fix positioning under toolbar */
:root[BookmarksToolbarOverlapsBrowser] #sidebar-box {
  padding-top: 0 !important;
}

/* Fullscreen behavior */
#main-window[inFullscreen="true"] #sidebar-box {
  display: none !important;
}

#main-window[inFullscreen="true"] #appcontent {
  margin-left: 0 !important;
}

/* Sidebar panel styling */
.sidebar-panel {
  background-color: transparent !important;
  color: var(--newtab-text-primary-color) !important;
}

.sidebar-panel #search-box {
  -moz-appearance: none !important;  
  background-color: rgba(249, 249, 250, 0.1) !important;
  color: inherit !important;
}

/* Move statuspanel when sidebar is hovered */
#sidebar-box:hover ~ #appcontent #statuspanel {
  inset-inline: auto 0px !important;
  margin-right: calc(var(--uc-sidebar-hover-width) - var(--uc-sidebar-width)) !important;
}

/* ========== END SIDEBAR SECTION ========== */

